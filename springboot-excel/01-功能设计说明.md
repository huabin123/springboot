# 01-åŠŸèƒ½è®¾è®¡è¯´æ˜

## ğŸ“Œ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®åŸºäº **Spring Boot 2.3.12** å’Œ **EasyExcel 3.0.2**ï¼Œå®ç°äº†ä¸€ä¸ªé«˜æ€§èƒ½çš„ Excel æ•°æ®å¯¼å‡ºåŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **é«˜æ€§èƒ½å¯¼å‡º**ï¼šä½¿ç”¨ EasyExcelï¼Œæ”¯æŒå¤§æ•°æ®é‡å¯¼å‡ºï¼ˆ10ä¸‡+ï¼‰
- âœ… **è¡¨å¤´æ˜ å°„**ï¼šæ”¯æŒè‹±æ–‡å­—æ®µååˆ°ä¸­æ–‡è¡¨å¤´çš„æ˜ å°„ï¼Œçµæ´»é…ç½®
- âœ… **æ•°æ®æˆªæ–­**ï¼šè¶…è¿‡ 10ä¸‡æ¡ è‡ªåŠ¨æˆªæ–­ï¼Œå¹¶åœ¨å“åº”å¤´è¿”å›è­¦å‘Šä¿¡æ¯
- âœ… **æµå¼å“åº”**ï¼šä½¿ç”¨ `HttpServletResponse` ç›´æ¥è¿”å›æµï¼Œæ— éœ€ç”Ÿæˆä¸´æ—¶æ–‡ä»¶
- âœ… **ä¸­æ–‡æ”¯æŒ**ï¼šå®Œç¾æ”¯æŒä¸­æ–‡æ–‡ä»¶åå’Œè¡¨å¤´
- âœ… **å†…å­˜ä¼˜åŒ–**ï¼šé‡‡ç”¨æµå¼å†™å…¥ï¼Œé¿å…å†…å­˜æº¢å‡º
- âœ… **æ¶æ„æ¸…æ™°**ï¼šåˆ†å±‚è®¾è®¡ï¼ŒèŒè´£æ˜ç¡®ï¼Œæ˜“äºæ‰©å±•

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 1. åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Controller å±‚                           â”‚
â”‚  ExcelExportController - æ¥æ”¶HTTPè¯·æ±‚ï¼Œå‚æ•°è§£æï¼Œå¼‚å¸¸å¤„ç†    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Service å±‚                             â”‚
â”‚  ExcelExportService - ä¸šåŠ¡é€»è¾‘ç¼–æ’ï¼Œæ•°æ®æŸ¥è¯¢ï¼Œå¯¼å‡ºåè°ƒ       â”‚
â”‚  MockDataService - æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆï¼ˆå®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºDAOå±‚ï¼‰     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Util å±‚                                â”‚
â”‚  ExcelExportUtil - å°è£…EasyExcelå¯¼å‡ºé€»è¾‘ï¼Œå“åº”å¤´è®¾ç½®         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Constant å±‚                             â”‚
â”‚  ExcelConstants - å¸¸é‡å®šä¹‰ï¼ˆæœ€å¤§è¡Œæ•°ã€å“åº”å¤´åç§°ç­‰ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ ¸å¿ƒç±»èŒè´£

| ç±»å | èŒè´£ | å…³é”®æ–¹æ³• |
|------|------|---------|
| **ExcelExportController** | HTTP è¯·æ±‚å¤„ç† | export(), exportLarge() |
| **ExcelExportService** | ä¸šåŠ¡é€»è¾‘ç¼–æ’ | exportData(), exportLargeData() |
| **MockDataService** | æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆ | queryData(), getHeaderMappings() |
| **ExcelExportUtil** | Excel å¯¼å‡ºå·¥å…· | exportToResponse() |
| **HeaderMapping** | è¡¨å¤´æ˜ å°„å®ä½“ | englishName, chineseName |
| **ExcelConstants** | å¸¸é‡å®šä¹‰ | MAX_EXPORT_ROWS, HEADER_* |

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½è®¾è®¡

### 1. æ•°æ®è¶…é•¿å¤„ç†æœºåˆ¶

**è®¾è®¡ç›®æ ‡**ï¼š
- é˜²æ­¢ä¸€æ¬¡æ€§å¯¼å‡ºè¿‡å¤šæ•°æ®å¯¼è‡´å†…å­˜æº¢å‡º
- æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·æ•°æ®è¢«æˆªæ–­
- æä¾›æ•°æ®æ€»é‡å’Œå®é™…å¯¼å‡ºé‡ä¿¡æ¯

**å®ç°æ–¹æ¡ˆ**ï¼š

```java
// 1. å®šä¹‰æœ€å¤§å¯¼å‡ºè¡Œæ•°
public static final int MAX_EXPORT_ROWS = 100000;

// 2. æ£€æŸ¥æ•°æ®é‡
int totalCount = dataList.size();
boolean isOverflow = totalCount > MAX_EXPORT_ROWS;

// 3. æˆªæ–­æ•°æ®
if (isOverflow) {
    exportData = dataList.subList(0, MAX_EXPORT_ROWS);
}

// 4. è®¾ç½®å“åº”å¤´
response.setHeader("X-Total-Count", String.valueOf(totalCount));
response.setHeader("X-Export-Count", String.valueOf(exportCount));
response.setHeader("X-Data-Overflow", "æ•°æ®æ€»é‡ 150000 æ¡ï¼Œå·²æˆªæ–­ä¸ºå‰ 100000 æ¡");
```

**å“åº”å¤´è¯´æ˜**ï¼š

| å“åº”å¤´ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `X-Total-Count` | æ•°æ®æ€»æ¡æ•° | 150000 |
| `X-Export-Count` | å®é™…å¯¼å‡ºæ¡æ•° | 100000 |
| `X-Data-Overflow` | æ•°æ®è¶…é•¿è­¦å‘Šï¼ˆä»…è¶…é•¿æ—¶è¿”å›ï¼‰ | "æ•°æ®æ€»é‡ 150000 æ¡ï¼Œè¶…è¿‡æœ€å¤§å¯¼å‡ºé™åˆ¶ 100000 æ¡ï¼Œå·²æˆªæ–­ä¸ºå‰ 100000 æ¡" |

### 2. è¡¨å¤´æ˜ å°„æœºåˆ¶

**è®¾è®¡ç›®æ ‡**ï¼š
- æ•°æ®åº“å­—æ®µé€šå¸¸æ˜¯è‹±æ–‡ï¼Œå¯¼å‡º Excel éœ€è¦ä¸­æ–‡è¡¨å¤´
- æ”¯æŒçµæ´»é…ç½®å­—æ®µé¡ºåº
- ä¿è¯å­—æ®µæ˜ å°„çš„å‡†ç¡®æ€§

**å®ç°æ–¹æ¡ˆ**ï¼š

```java
// 1. æ•°æ®åº“æŸ¥è¯¢è¿”å›è‹±æ–‡å­—æ®µå
LinkedHashMap<String, Object> row = new LinkedHashMap<>();
row.put("orderNo", "ORD0000000001");
row.put("customerName", "å¼ ä¼Ÿ");
row.put("amount", new BigDecimal("99.99"));

// 2. å®šä¹‰è¡¨å¤´æ˜ å°„ï¼ˆè‹±æ–‡ -> ä¸­æ–‡ï¼‰
List<HeaderMapping> mappings = new ArrayList<>();
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));

// 3. å¯¼å‡ºæ—¶è‡ªåŠ¨è½¬æ¢
// - ä»æ•°æ®ä¸­æŒ‰è‹±æ–‡å­—æ®µåå–å€¼
// - Excel è¡¨å¤´æ˜¾ç¤ºä¸­æ–‡åç§°
ExcelExportUtil.exportToResponse(response, dataList, mappings, fileName, sheetName);
```

**ä¼˜åŠ¿**ï¼š
- âœ… çœŸå®åœºæ™¯ï¼šç¬¦åˆæ•°æ®åº“å­—æ®µè‹±æ–‡ã€ç•Œé¢æ˜¾ç¤ºä¸­æ–‡çš„å®é™…éœ€æ±‚
- âœ… çµæ´»é…ç½®ï¼šå¯ä»¥è‡ªç”±è°ƒæ•´å­—æ®µé¡ºåºå’Œæ˜¾ç¤ºåç§°
- âœ… æ˜“äºç»´æŠ¤ï¼šæ˜ å°„å…³ç³»é›†ä¸­ç®¡ç†ï¼Œä¾¿äºä¿®æ”¹

### 3. æµå¼å“åº”è®¾è®¡

**è®¾è®¡ç›®æ ‡**ï¼š
- ç›´æ¥å†™å…¥ HTTP å“åº”æµ
- æ— éœ€ç”Ÿæˆä¸´æ—¶æ–‡ä»¶
- èŠ‚çœç£ç›˜ç©ºé—´å’Œ IO å¼€é”€

**å®ç°æ–¹æ¡ˆ**ï¼š

```java
// 1. è®¾ç½®å“åº”å¤´
response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
response.setHeader("Content-Disposition", "attachment;filename=export.xlsx");

// 2. è·å–è¾“å‡ºæµ
OutputStream outputStream = response.getOutputStream();

// 3. ä½¿ç”¨ EasyExcel å†™å…¥æµ
EasyExcel.write(outputStream)
    .sheet("æ•°æ®å¯¼å‡º")
    .head(headers)
    .doWrite(data);

// 4. åˆ·æ–°å¹¶å…³é—­æµ
outputStream.flush();
outputStream.close();
```

**ä¼˜åŠ¿**ï¼š
- âœ… é«˜æ•ˆï¼šç›´æ¥å†™å…¥å“åº”æµï¼Œæ— ä¸­é—´æ–‡ä»¶
- âœ… èŠ‚çœï¼šä¸å ç”¨ç£ç›˜ç©ºé—´
- âœ… å®‰å…¨ï¼šæ— ä¸´æ—¶æ–‡ä»¶æ³„éœ²é£é™©

### 4. ä¸­æ–‡æ–‡ä»¶åå¤„ç†

**é—®é¢˜**ï¼š
- æµè§ˆå™¨ä¸‹è½½æ—¶ä¸­æ–‡æ–‡ä»¶åä¹±ç 
- ä¸åŒæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// 1. URL ç¼–ç æ–‡ä»¶å
String encodedFileName = URLEncoder.encode(fileName, "UTF-8")
    .replaceAll("\\+", "%20");

// 2. è®¾ç½® Content-Dispositionï¼ˆå…¼å®¹å¤šç§æµè§ˆå™¨ï¼‰
String fullFileName = encodedFileName + ".xlsx";
response.setHeader("Content-Disposition", 
    "attachment;filename=" + fullFileName + ";filename*=utf-8''" + fullFileName);
```

**å…¼å®¹æ€§**ï¼š
- âœ… Chrome / Edge
- âœ… Firefox
- âœ… Safari
- âœ… IE 11+

---

## ğŸ“Š æ•°æ®æ¨¡æ‹Ÿè®¾è®¡

### 1. æ¨¡æ‹Ÿæ•°æ®ç»“æ„

```java
// æ•°æ®åº“æŸ¥è¯¢è¿”å›è‹±æ–‡å­—æ®µå
LinkedHashMap<String, Object> row = new LinkedHashMap<>();
row.put("orderNo", "ORD0000000001");           // String - è®¢å•ç¼–å·
row.put("customerName", "å¼ ä¼Ÿ");                // String - å®¢æˆ·å§“å
row.put("phone", "13012345678");               // String - è”ç³»ç”µè¯
row.put("amount", new BigDecimal("99.99"));    // BigDecimal - è®¢å•é‡‘é¢
row.put("status", "å·²æ”¯ä»˜");                    // String - è®¢å•çŠ¶æ€
row.put("orderTime", "2025-12-30 19:40:00");   // String - ä¸‹å•æ—¶é—´
row.put("address", "åŒ—äº¬å¸‚æœé˜³åŒºä¸­å±±è·¯1å·");     // String - æ”¶è´§åœ°å€
row.put("productName", "ç”µå­äº§å“-iPhone");      // String - å•†å“åç§°
row.put("quantity", 2);                        // Integer - å•†å“æ•°é‡
row.put("remark", "è¯·å°½å¿«å‘è´§ï¼Œè°¢è°¢ï¼");         // String - å¤‡æ³¨ä¿¡æ¯

// è¡¨å¤´æ˜ å°„é…ç½®
List<HeaderMapping> mappings = new ArrayList<>();
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
mappings.add(new HeaderMapping("phone", "è”ç³»ç”µè¯"));
mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));
mappings.add(new HeaderMapping("status", "è®¢å•çŠ¶æ€"));
mappings.add(new HeaderMapping("orderTime", "ä¸‹å•æ—¶é—´"));
mappings.add(new HeaderMapping("address", "æ”¶è´§åœ°å€"));
mappings.add(new HeaderMapping("productName", "å•†å“åç§°"));
mappings.add(new HeaderMapping("quantity", "å•†å“æ•°é‡"));
mappings.add(new HeaderMapping("remark", "å¤‡æ³¨ä¿¡æ¯"));
```

### 2. æ•°æ®ç”Ÿæˆç­–ç•¥

| å­—æ®µ | ç”Ÿæˆè§„åˆ™ | ç¤ºä¾‹ |
|------|---------|------|
| è®¢å•ç¼–å· | ORD + 10ä½åºå· | ORD0000000001 |
| å®¢æˆ·å§“å | å§“æ° + åå­—ï¼ˆå¾ªç¯ï¼‰ | å¼ ä¼Ÿã€ç‹èŠ³ã€æå¨œ |
| è”ç³»ç”µè¯ | 130 + 8ä½æ•°å­— | 13012345678 |
| è®¢å•é‡‘é¢ | 10 + (index % 10000) * 0.99 | 99.99 |
| è®¢å•çŠ¶æ€ | 5ç§çŠ¶æ€å¾ªç¯ | å¾…æ”¯ä»˜ã€å·²æ”¯ä»˜ã€é…é€ä¸­ã€å·²å®Œæˆã€å·²å–æ¶ˆ |
| ä¸‹å•æ—¶é—´ | å½“å‰æ—¶é—´ - indexåˆ†é’Ÿ | 2025-12-30 19:40:00 |
| æ”¶è´§åœ°å€ | çœå¸‚åŒºè¡—é“ + é—¨ç‰Œå· | åŒ—äº¬å¸‚æœé˜³åŒºä¸­å±±è·¯1å· |
| å•†å“åç§° | ç±»åˆ« + äº§å“å | ç”µå­äº§å“-iPhone |
| å•†å“æ•°é‡ | (index % 10) + 1 | 1-10 |
| å¤‡æ³¨ä¿¡æ¯ | æ¡ä»¶ç”Ÿæˆ | è¯·å°½å¿«å‘è´§ã€å‘¨æœ«é…é€ã€ç©º |

### 3. æ€§èƒ½ä¼˜åŒ–

```java
// 1. é¢„åˆ†é…å®¹é‡
List<LinkedHashMap<String, Object>> dataList = new ArrayList<>(count);

// 2. æ‰¹é‡ç”Ÿæˆï¼Œå®šæœŸæ‰“å°è¿›åº¦
for (int i = 1; i <= count; i++) {
    // ç”Ÿæˆæ•°æ®...
    
    if (i % 10000 == 0) {
        logger.info("æ•°æ®ç”Ÿæˆè¿›åº¦: {}/{}", i, count);
    }
}
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### 1. å¸¸é‡é…ç½®

```java
// ExcelConstants.java

// æœ€å¤§å¯¼å‡ºè¡Œæ•°
public static final int MAX_EXPORT_ROWS = 100000;

// å“åº”å¤´åç§°
public static final String HEADER_DATA_OVERFLOW = "X-Data-Overflow";
public static final String HEADER_TOTAL_COUNT = "X-Total-Count";
public static final String HEADER_EXPORT_COUNT = "X-Export-Count";

// é»˜è®¤å€¼
public static final String DEFAULT_SHEET_NAME = "æ•°æ®å¯¼å‡º";
public static final String DEFAULT_FILE_PREFIX = "export_data_";
```

### 2. åº”ç”¨é…ç½®

```yaml
# application.yml

server:
  port: 8080
  servlet:
    encoding:
      charset: UTF-8
      enabled: true
      force: true

logging:
  level:
    com.huabin.excel.export: DEBUG
```

---

## ğŸ”’ å®‰å…¨æ€§è®¾è®¡

### 1. å‚æ•°æ ¡éªŒ

```java
// 1. æ•°æ®æ¡æ•°æ ¡éªŒ
if (count == null || count <= 0) {
    count = 1000; // é»˜è®¤å€¼
}

// 2. æœ€å¤§æŸ¥è¯¢é™åˆ¶ï¼ˆé˜²æ­¢å†…å­˜æº¢å‡ºï¼‰
int maxQueryCount = 1000000;
if (count > maxQueryCount) {
    count = maxQueryCount;
}

// 3. æ–‡ä»¶åæ ¡éªŒ
if (fileName == null || fileName.trim().isEmpty()) {
    fileName = generateDefaultFileName();
}
```

### 2. å¼‚å¸¸å¤„ç†

```java
try {
    excelExportService.exportData(response, count, fileName, sheetName);
} catch (IOException e) {
    logger.error("Excel å¯¼å‡ºå¤±è´¥", e);
    handleExportError(response, e);
}
```

### 3. èµ„æºç®¡ç†

```java
OutputStream outputStream = null;
try {
    outputStream = response.getOutputStream();
    // å¯¼å‡ºé€»è¾‘...
} finally {
    if (outputStream != null) {
        outputStream.flush();
        outputStream.close();
    }
}
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### 1. æ•°æ®ç”Ÿæˆæ€§èƒ½

| æ•°æ®é‡ | ç”Ÿæˆè€—æ—¶ | å†…å­˜å ç”¨ |
|--------|---------|---------|
| 1,000 | ~50ms | ~5MB |
| 10,000 | ~200ms | ~50MB |
| 100,000 | ~2s | ~500MB |
| 1,000,000 | ~20s | ~5GB |

### 2. å¯¼å‡ºæ€§èƒ½

| æ•°æ®é‡ | å¯¼å‡ºè€—æ—¶ | æ–‡ä»¶å¤§å° |
|--------|---------|---------|
| 1,000 | ~100ms | ~50KB |
| 10,000 | ~500ms | ~500KB |
| 100,000 | ~5s | ~5MB |

**ä¼˜åŒ–å»ºè®®**ï¼š
- æ•°æ®é‡ < 10ä¸‡ï¼šç›´æ¥å¯¼å‡º
- æ•°æ®é‡ 10ä¸‡-100ä¸‡ï¼šåˆ†æ‰¹å¯¼å‡ºæˆ–å¼‚æ­¥å¯¼å‡º
- æ•°æ®é‡ > 100ä¸‡ï¼šå»ºè®®ä½¿ç”¨ç¦»çº¿ä»»åŠ¡ + æ–‡ä»¶ä¸‹è½½

---

## ğŸ¨ æ‰©å±•æ€§è®¾è®¡

### 1. è‡ªå®šä¹‰æ•°æ®æº

```java
// æ›¿æ¢ MockDataService ä¸ºå®é™…çš„ DAO å±‚
@Service
public class OrderDataService {
    
    @Autowired
    private OrderMapper orderMapper;
    
    public List<LinkedHashMap<String, Object>> queryOrders(int limit) {
        // ä»æ•°æ®åº“æŸ¥è¯¢
        List<Order> orders = orderMapper.selectList(limit);
        
        // è½¬æ¢ä¸º LinkedHashMap
        return convertToMap(orders);
    }
}
```

### 2. è‡ªå®šä¹‰å¯¼å‡ºæ ¼å¼

```java
// æ”¯æŒè‡ªå®šä¹‰æ ·å¼ã€åˆå¹¶å•å…ƒæ ¼ç­‰
ExcelWriterBuilder writerBuilder = EasyExcel.write(outputStream);
writerBuilder.registerWriteHandler(new CustomStyleHandler());
writerBuilder.sheet("æ•°æ®").doWrite(data);
```

### 3. å¼‚æ­¥å¯¼å‡º

```java
// å¤§æ•°æ®é‡å¼‚æ­¥å¯¼å‡ºï¼Œç”Ÿæˆæ–‡ä»¶åé€šçŸ¥ç”¨æˆ·ä¸‹è½½
@Async
public CompletableFuture<String> exportAsync(int count) {
    String filePath = exportToFile(count);
    // å‘é€é€šçŸ¥...
    return CompletableFuture.completedFuture(filePath);
}
```

---

## ğŸ“š æŠ€æœ¯é€‰å‹è¯´æ˜

### 1. ä¸ºä»€ä¹ˆé€‰æ‹© EasyExcelï¼Ÿ

| å¯¹æ¯”é¡¹ | EasyExcel | Apache POI | JXL |
|--------|-----------|-----------|-----|
| **æ€§èƒ½** | â­â­â­â­â­ | â­â­â­ | â­â­ |
| **å†…å­˜å ç”¨** | ä½ï¼ˆæµå¼ï¼‰ | é«˜ | ä¸­ |
| **API ç®€æ´æ€§** | â­â­â­â­â­ | â­â­â­ | â­â­ |
| **å¤§æ•°æ®æ”¯æŒ** | æ”¯æŒç™¾ä¸‡çº§ | æ”¯æŒåä¸‡çº§ | ä¸æ”¯æŒ |
| **ç»´æŠ¤çŠ¶æ€** | æ´»è·ƒ | æ´»è·ƒ | åœæ­¢ç»´æŠ¤ |

### 2. ä¸ºä»€ä¹ˆä½¿ç”¨ LinkedHashMapï¼Ÿ

- âœ… **æœ‰åºæ€§**ï¼šä¿è¯å­—æ®µé¡ºåºä¸æ’å…¥é¡ºåºä¸€è‡´
- âœ… **çµæ´»æ€§**ï¼šæ— éœ€é¢„å®šä¹‰å®ä½“ç±»
- âœ… **å…¼å®¹æ€§**ï¼šä¸ EasyExcel å®Œç¾é…åˆ
- âœ… **æ€§èƒ½**ï¼šO(1) æŸ¥æ‰¾ï¼Œæ€§èƒ½ä¼˜å¼‚

### 3. ä¸ºä»€ä¹ˆä½¿ç”¨æµå¼å“åº”ï¼Ÿ

- âœ… **å®æ—¶æ€§**ï¼šç”¨æˆ·ç«‹å³å¼€å§‹ä¸‹è½½
- âœ… **èŠ‚çœç©ºé—´**ï¼šæ— éœ€ä¸´æ—¶æ–‡ä»¶
- âœ… **å®‰å…¨æ€§**ï¼šæ— æ–‡ä»¶æ³„éœ²é£é™©
- âœ… **å¯æ‰©å±•**ï¼šæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼ˆéœ€é¢å¤–å®ç°ï¼‰

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆé™åˆ¶æœ€å¤§å¯¼å‡º 10ä¸‡æ¡ï¼Ÿ

**A:** 
1. **å†…å­˜è€ƒè™‘**ï¼š10ä¸‡æ¡æ•°æ®çº¦å ç”¨ 500MB å†…å­˜ï¼Œæ˜¯å®‰å…¨é˜ˆå€¼
2. **ç”¨æˆ·ä½“éªŒ**ï¼š10ä¸‡æ¡æ•°æ®å¯¼å‡ºçº¦éœ€ 5ç§’ï¼Œè¶…è¿‡ä¼šå½±å“ä½“éªŒ
3. **Excel é™åˆ¶**ï¼šExcel 2007+ æœ€å¤§æ”¯æŒ 104ä¸‡è¡Œï¼Œ10ä¸‡æ˜¯åˆç†èŒƒå›´
4. **ä¸šåŠ¡éœ€æ±‚**ï¼šè¶…è¿‡ 10ä¸‡æ¡å»ºè®®åˆ†æ‰¹å¯¼å‡ºæˆ–ç¦»çº¿å¤„ç†

### Q2: å¦‚ä½•å¤„ç†è¶…å¤§æ•°æ®é‡ï¼ˆç™¾ä¸‡çº§ï¼‰ï¼Ÿ

**A:** 
1. **åˆ†æ‰¹å¯¼å‡º**ï¼šæ¯æ¬¡å¯¼å‡º 10ä¸‡æ¡ï¼Œç”Ÿæˆå¤šä¸ªæ–‡ä»¶
2. **å¼‚æ­¥ä»»åŠ¡**ï¼šåå°ç”Ÿæˆæ–‡ä»¶ï¼Œå®Œæˆåé€šçŸ¥ç”¨æˆ·ä¸‹è½½
3. **æ•°æ®åº“åˆ†é¡µ**ï¼šä½¿ç”¨ LIMIT OFFSET åˆ†é¡µæŸ¥è¯¢
4. **å‹ç¼©æ–‡ä»¶**ï¼šå¤šä¸ª Excel æ‰“åŒ…æˆ ZIP

### Q3: å¦‚ä½•è‡ªå®šä¹‰å¯¼å‡ºæ ·å¼ï¼Ÿ

**A:** 
```java
// ä½¿ç”¨ EasyExcel çš„ WriteHandler
ExcelWriterBuilder writerBuilder = EasyExcel.write(outputStream);
writerBuilder.registerWriteHandler(new CustomCellStyleHandler());
writerBuilder.sheet("æ•°æ®").doWrite(data);
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [02-æ ¸å¿ƒä»£ç è¯´æ˜.md](./02-æ ¸å¿ƒä»£ç è¯´æ˜.md) - è¯¦ç»†ä»£ç è§£æ
- [03-ä½¿ç”¨ç¤ºä¾‹.md](./03-ä½¿ç”¨ç¤ºä¾‹.md) - æ¥å£è°ƒç”¨ç¤ºä¾‹
- [README.md](./README.md) - é¡¹ç›®æ€»è§ˆ

---

## ğŸ“ æ€»ç»“

æœ¬åŠŸèƒ½è®¾è®¡éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

1. **é«˜æ€§èƒ½**ï¼šä½¿ç”¨ EasyExcel æµå¼å†™å…¥ï¼Œæ”¯æŒå¤§æ•°æ®é‡
2. **é«˜å¯ç”¨**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œèµ„æºç®¡ç†
3. **é«˜æ‰©å±•**ï¼šåˆ†å±‚æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
4. **é«˜å®‰å…¨**ï¼šå‚æ•°æ ¡éªŒã€æ•°æ®æˆªæ–­ã€èµ„æºé‡Šæ”¾
5. **é«˜ä½“éªŒ**ï¼šä¸­æ–‡æ”¯æŒã€è¿›åº¦æç¤ºã€é”™è¯¯åé¦ˆ

é€‚ç”¨åœºæ™¯ï¼š
- âœ… è®¢å•æ•°æ®å¯¼å‡º
- âœ… æŠ¥è¡¨æ•°æ®å¯¼å‡º
- âœ… ç”¨æˆ·æ•°æ®å¯¼å‡º
- âœ… ä»»æ„ç»“æ„åŒ–æ•°æ®å¯¼å‡º
