# 03-ä½¿ç”¨ç¤ºä¾‹

## ğŸ“Œ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›è¯¦ç»†çš„æ¥å£è°ƒç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬å„ç§åœºæ™¯ä¸‹çš„ä½¿ç”¨æ–¹æ³•å’Œå“åº”ç¤ºä¾‹ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åº”ç”¨

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd springboot-excel

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run
```

**å¯åŠ¨æˆåŠŸæ—¥å¿—**ï¼š

```
========================================
Excel å¯¼å‡ºæœåŠ¡å¯åŠ¨æˆåŠŸï¼
è®¿é—®åœ°å€: http://localhost:8080
å¯¼å‡ºæ¥å£: http://localhost:8080/api/excel/export
========================================
```

### 2. å¥åº·æ£€æŸ¥

```bash
curl http://localhost:8080/api/excel/health
```

**å“åº”**ï¼š

```
Excel Export Service is running!
```

---

## ğŸ“‹ æ¥å£è°ƒç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šåŸºç¡€å¯¼å‡ºï¼ˆä½¿ç”¨é»˜è®¤å‚æ•°ï¼‰

**è¯·æ±‚**ï¼š

```bash
curl -O -J http://localhost:8080/api/excel/export
```

**è¯´æ˜**ï¼š
- ä¸ä¼ ä»»ä½•å‚æ•°
- ä½¿ç”¨é»˜è®¤æ•°æ®é‡ï¼š1000 æ¡
- ä½¿ç”¨é»˜è®¤æ–‡ä»¶åï¼š`export_data_yyyyMMdd_HHmmss.xlsx`
- ä½¿ç”¨é»˜è®¤ Sheet åç§°ï¼š`æ•°æ®å¯¼å‡º`

**å“åº”å¤´**ï¼š

```
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Content-Disposition: attachment;filename=export_data_20251230_194000.xlsx;filename*=utf-8''export_data_20251230_194000.xlsx
X-Total-Count: 1000
X-Export-Count: 1000
```

**æ–‡ä»¶å†…å®¹**ï¼š

| è®¢å•ç¼–å· | å®¢æˆ·å§“å | è”ç³»ç”µè¯ | è®¢å•é‡‘é¢ | è®¢å•çŠ¶æ€ | ä¸‹å•æ—¶é—´ | æ”¶è´§åœ°å€ | å•†å“åç§° | å•†å“æ•°é‡ | å¤‡æ³¨ä¿¡æ¯ |
|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| ORD0000000001 | å¼ ä¼Ÿ | 13000000001 | 10.99 | å¾…æ”¯ä»˜ | 2025-12-30 19:40:00 | åŒ—äº¬å¸‚æœé˜³åŒºä¸­å±±è·¯1å· | ç”µå­äº§å“-iPhone | 2 | |
| ORD0000000002 | ç‹èŠ³ | 13000000002 | 11.98 | å·²æ”¯ä»˜ | 2025-12-30 19:39:00 | ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºäººæ°‘è·¯2å· | æœè£…é‹å¸½-Tæ¤ | 3 | |
| ... | ... | ... | ... | ... | ... | ... | ... | ... | ... |

---

### ç¤ºä¾‹ 2ï¼šæŒ‡å®šæ•°æ®é‡

**è¯·æ±‚**ï¼š

```bash
curl -O -J "http://localhost:8080/api/excel/export?count=5000"
```

**è¯´æ˜**ï¼š
- å¯¼å‡º 5000 æ¡æ•°æ®
- å…¶ä»–å‚æ•°ä½¿ç”¨é»˜è®¤å€¼

**å“åº”å¤´**ï¼š

```
X-Total-Count: 5000
X-Export-Count: 5000
```

**æ§åˆ¶å°æ—¥å¿—**ï¼š

```
2025-12-30 19:40:00.123 [http-nio-8080-exec-1] INFO  MockDataService - å¼€å§‹æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®ï¼Œæ•°æ®é‡: 5000
2025-12-30 19:40:00.456 [http-nio-8080-exec-1] INFO  MockDataService - æ•°æ®æŸ¥è¯¢å®Œæˆï¼Œæ•°æ®é‡: 5000, è€—æ—¶: 333ms
2025-12-30 19:40:01.789 [http-nio-8080-exec-1] INFO  ExcelExportUtil - Excel å¯¼å‡ºæˆåŠŸï¼Œå¯¼å‡ºæ•°æ®é‡: 5000, è€—æ—¶: 1333ms
```

---

### ç¤ºä¾‹ 3ï¼šè‡ªå®šä¹‰æ–‡ä»¶åå’Œ Sheet åç§°

**è¯·æ±‚**ï¼š

```bash
curl -O -J "http://localhost:8080/api/excel/export?count=3000&fileName=è®¢å•æ•°æ®&sheetName=è®¢å•åˆ—è¡¨"
```

**è¯´æ˜**ï¼š
- å¯¼å‡º 3000 æ¡æ•°æ®
- æ–‡ä»¶åï¼š`è®¢å•æ•°æ®.xlsx`
- Sheet åç§°ï¼š`è®¢å•åˆ—è¡¨`

**å“åº”å¤´**ï¼š

```
Content-Disposition: attachment;filename=%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE.xlsx;filename*=utf-8''%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE.xlsx
X-Total-Count: 3000
X-Export-Count: 3000
```

**ä¸‹è½½æ–‡ä»¶**ï¼š
- æ–‡ä»¶åï¼š`è®¢å•æ•°æ®.xlsx`
- Sheet åç§°ï¼š`è®¢å•åˆ—è¡¨`

---

### ç¤ºä¾‹ 4ï¼šå¤§æ•°æ®é‡å¯¼å‡ºï¼ˆè¶…è¿‡ 10 ä¸‡æ¡ï¼‰

**è¯·æ±‚**ï¼š

```bash
curl -O -J "http://localhost:8080/api/excel/export?count=150000"
```

**è¯´æ˜**ï¼š
- è¯·æ±‚å¯¼å‡º 150000 æ¡æ•°æ®
- å®é™…åªå¯¼å‡ºå‰ 100000 æ¡ï¼ˆè¾¾åˆ°æœ€å¤§é™åˆ¶ï¼‰
- å“åº”å¤´ä¸­è¿”å›è­¦å‘Šä¿¡æ¯

**å“åº”å¤´**ï¼š

```
X-Total-Count: 150000
X-Export-Count: 100000
X-Data-Overflow: %E6%95%B0%E6%8D%AE%E6%80%BB%E9%87%8F%20150000%20%E6%9D%A1%EF%BC%8C%E8%B6%85%E8%BF%87%E6%9C%80%E5%A4%A7%E5%AF%BC%E5%87%BA%E9%99%90%E5%88%B6%20100000%20%E6%9D%A1%EF%BC%8C%E5%B7%B2%E6%88%AA%E6%96%AD%E4%B8%BA%E5%89%8D%20100000%20%E6%9D%A1
```

**è§£ç åçš„è­¦å‘Šä¿¡æ¯**ï¼š

```
æ•°æ®æ€»é‡ 150000 æ¡ï¼Œè¶…è¿‡æœ€å¤§å¯¼å‡ºé™åˆ¶ 100000 æ¡ï¼Œå·²æˆªæ–­ä¸ºå‰ 100000 æ¡
```

**æ§åˆ¶å°æ—¥å¿—**ï¼š

```
2025-12-30 19:40:00.123 [http-nio-8080-exec-1] INFO  MockDataService - å¼€å§‹æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®ï¼Œæ•°æ®é‡: 150000
2025-12-30 19:40:10.123 [http-nio-8080-exec-1] INFO  MockDataService - æ•°æ®ç”Ÿæˆè¿›åº¦: 10000/150000
2025-12-30 19:40:20.123 [http-nio-8080-exec-1] INFO  MockDataService - æ•°æ®ç”Ÿæˆè¿›åº¦: 20000/150000
...
2025-12-30 19:41:00.123 [http-nio-8080-exec-1] INFO  MockDataService - æ•°æ®æŸ¥è¯¢å®Œæˆï¼Œæ•°æ®é‡: 150000, è€—æ—¶: 60000ms
2025-12-30 19:41:00.456 [http-nio-8080-exec-1] WARN  ExcelExportUtil - æ•°æ®é‡è¶…è¿‡æœ€å¤§é™åˆ¶ 100000ï¼Œå®é™…æ•°æ®é‡: 150000ï¼Œå°†åªå¯¼å‡ºå‰ 100000 æ¡
2025-12-30 19:41:05.789 [http-nio-8080-exec-1] INFO  ExcelExportUtil - Excel å¯¼å‡ºæˆåŠŸï¼Œå¯¼å‡ºæ•°æ®é‡: 100000, è€—æ—¶: 5333ms
```

---

### ç¤ºä¾‹ 5ï¼šå¤§æ•°æ®é‡æµ‹è¯•æ¥å£

**è¯·æ±‚**ï¼š

```bash
curl -O -J http://localhost:8080/api/excel/export/large
```

**è¯´æ˜**ï¼š
- ä¸“é—¨ç”¨äºæµ‹è¯•å¤§æ•°æ®é‡åœºæ™¯
- å›ºå®šå¯¼å‡º 150000 æ¡æ•°æ®
- è‡ªåŠ¨æˆªæ–­ä¸º 100000 æ¡
- æ–‡ä»¶åï¼š`å¤§æ•°æ®é‡å¯¼å‡ºæµ‹è¯•.xlsx`
- Sheet åç§°ï¼š`è®¢å•æ•°æ®`

**å“åº”å¤´**ï¼š

```
Content-Disposition: attachment;filename=%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%AF%BC%E5%87%BA%E6%B5%8B%E8%AF%95.xlsx;filename*=utf-8''%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%AF%BC%E5%87%BA%E6%B5%8B%E8%AF%95.xlsx
X-Total-Count: 150000
X-Export-Count: 100000
X-Data-Overflow: %E6%95%B0%E6%8D%AE%E6%80%BB%E9%87%8F%20150000%20%E6%9D%A1%EF%BC%8C%E8%B6%85%E8%BF%87%E6%9C%80%E5%A4%A7%E5%AF%BC%E5%87%BA%E9%99%90%E5%88%B6%20100000%20%E6%9D%A1%EF%BC%8C%E5%B7%B2%E6%88%AA%E6%96%AD%E4%B8%BA%E5%89%8D%20100000%20%E6%9D%A1
```

---

## ğŸŒ æµè§ˆå™¨è°ƒç”¨ç¤ºä¾‹

### 1. ç›´æ¥è®¿é—® URL

åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ï¼š

```
http://localhost:8080/api/excel/export?count=5000&fileName=è®¢å•æ•°æ®&sheetName=è®¢å•åˆ—è¡¨
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨ä¸‹è½½æ–‡ä»¶ï¼š`è®¢å•æ•°æ®.xlsx`

### 2. ä½¿ç”¨ JavaScript è°ƒç”¨

```javascript
// æ–¹å¼ 1ï¼šç›´æ¥è·³è½¬
window.location.href = 'http://localhost:8080/api/excel/export?count=5000';

// æ–¹å¼ 2ï¼šä½¿ç”¨ fetchï¼ˆå¯ä»¥è·å–å“åº”å¤´ï¼‰
fetch('http://localhost:8080/api/excel/export?count=5000')
    .then(response => {
        // è·å–å“åº”å¤´
        const totalCount = response.headers.get('X-Total-Count');
        const exportCount = response.headers.get('X-Export-Count');
        const overflow = response.headers.get('X-Data-Overflow');
        
        console.log('æ€»æ•°æ®é‡:', totalCount);
        console.log('å¯¼å‡ºæ•°é‡:', exportCount);
        
        if (overflow) {
            const warningMessage = decodeURIComponent(overflow);
            alert('è­¦å‘Š: ' + warningMessage);
        }
        
        // ä¸‹è½½æ–‡ä»¶
        return response.blob();
    })
    .then(blob => {
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'è®¢å•æ•°æ®.xlsx';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        document.body.removeChild(a);
    })
    .catch(error => {
        console.error('å¯¼å‡ºå¤±è´¥:', error);
    });

// æ–¹å¼ 3ï¼šä½¿ç”¨ axios
axios({
    url: 'http://localhost:8080/api/excel/export',
    method: 'GET',
    params: {
        count: 5000,
        fileName: 'è®¢å•æ•°æ®',
        sheetName: 'è®¢å•åˆ—è¡¨'
    },
    responseType: 'blob'
})
.then(response => {
    // è·å–å“åº”å¤´
    const totalCount = response.headers['x-total-count'];
    const exportCount = response.headers['x-export-count'];
    const overflow = response.headers['x-data-overflow'];
    
    console.log('æ€»æ•°æ®é‡:', totalCount);
    console.log('å¯¼å‡ºæ•°é‡:', exportCount);
    
    if (overflow) {
        const warningMessage = decodeURIComponent(overflow);
        alert('è­¦å‘Š: ' + warningMessage);
    }
    
    // ä¸‹è½½æ–‡ä»¶
    const url = window.URL.createObjectURL(new Blob([response.data]));
    const link = document.createElement('a');
    link.href = url;
    link.setAttribute('download', 'è®¢å•æ•°æ®.xlsx');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
})
.catch(error => {
    console.error('å¯¼å‡ºå¤±è´¥:', error);
});
```

---

## ğŸ“± Postman è°ƒç”¨ç¤ºä¾‹

### 1. é…ç½®è¯·æ±‚

**è¯·æ±‚æ–¹å¼**ï¼š`GET`

**è¯·æ±‚ URL**ï¼š
```
http://localhost:8080/api/excel/export
```

**Query Params**ï¼š

| Key | Value | Description |
|-----|-------|-------------|
| count | 5000 | æ•°æ®æ¡æ•° |
| fileName | è®¢å•æ•°æ® | æ–‡ä»¶å |
| sheetName | è®¢å•åˆ—è¡¨ | Sheet åç§° |

### 2. å‘é€è¯·æ±‚

ç‚¹å‡» `Send` æŒ‰é’®

### 3. æŸ¥çœ‹å“åº”

**Headers**ï¼š

```
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Content-Disposition: attachment;filename=%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE.xlsx;filename*=utf-8''%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE.xlsx
X-Total-Count: 5000
X-Export-Count: 5000
```

**Body**ï¼š

ç‚¹å‡» `Save Response` -> `Save to a file` ä¿å­˜ä¸º Excel æ–‡ä»¶

---

## ğŸ Python è°ƒç”¨ç¤ºä¾‹

### ä½¿ç”¨ requests åº“

```python
import requests
from urllib.parse import unquote

# 1. åŸºç¡€å¯¼å‡º
response = requests.get('http://localhost:8080/api/excel/export', params={
    'count': 5000,
    'fileName': 'è®¢å•æ•°æ®',
    'sheetName': 'è®¢å•åˆ—è¡¨'
})

# 2. æ£€æŸ¥å“åº”å¤´
total_count = response.headers.get('X-Total-Count')
export_count = response.headers.get('X-Export-Count')
overflow = response.headers.get('X-Data-Overflow')

print(f'æ€»æ•°æ®é‡: {total_count}')
print(f'å¯¼å‡ºæ•°é‡: {export_count}')

if overflow:
    warning_message = unquote(overflow)
    print(f'è­¦å‘Š: {warning_message}')

# 3. ä¿å­˜æ–‡ä»¶
with open('è®¢å•æ•°æ®.xlsx', 'wb') as f:
    f.write(response.content)

print('æ–‡ä»¶ä¸‹è½½æˆåŠŸ: è®¢å•æ•°æ®.xlsx')
```

**è¾“å‡º**ï¼š

```
æ€»æ•°æ®é‡: 5000
å¯¼å‡ºæ•°é‡: 5000
æ–‡ä»¶ä¸‹è½½æˆåŠŸ: è®¢å•æ•°æ®.xlsx
```

---

## â˜• Java è°ƒç”¨ç¤ºä¾‹

### ä½¿ç”¨ RestTemplate

```java
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseEntity;
import org.springframework.web.client.RestTemplate;

import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URLDecoder;

public class ExcelExportClient {

    public static void main(String[] args) throws IOException {
        RestTemplate restTemplate = new RestTemplate();
        
        // 1. æ„å»ºè¯·æ±‚ URL
        String url = "http://localhost:8080/api/excel/export?count=5000&fileName=è®¢å•æ•°æ®&sheetName=è®¢å•åˆ—è¡¨";
        
        // 2. å‘é€è¯·æ±‚
        ResponseEntity<byte[]> response = restTemplate.getForEntity(url, byte[].class);
        
        // 3. è·å–å“åº”å¤´
        HttpHeaders headers = response.getHeaders();
        String totalCount = headers.getFirst("X-Total-Count");
        String exportCount = headers.getFirst("X-Export-Count");
        String overflow = headers.getFirst("X-Data-Overflow");
        
        System.out.println("æ€»æ•°æ®é‡: " + totalCount);
        System.out.println("å¯¼å‡ºæ•°é‡: " + exportCount);
        
        if (overflow != null) {
            String warningMessage = URLDecoder.decode(overflow, "UTF-8");
            System.out.println("è­¦å‘Š: " + warningMessage);
        }
        
        // 4. ä¿å­˜æ–‡ä»¶
        byte[] data = response.getBody();
        try (FileOutputStream fos = new FileOutputStream("è®¢å•æ•°æ®.xlsx")) {
            fos.write(data);
        }
        
        System.out.println("æ–‡ä»¶ä¸‹è½½æˆåŠŸ: è®¢å•æ•°æ®.xlsx");
    }
}
```

**è¾“å‡º**ï¼š

```
æ€»æ•°æ®é‡: 5000
å¯¼å‡ºæ•°é‡: 5000
æ–‡ä»¶ä¸‹è½½æˆåŠŸ: è®¢å•æ•°æ®.xlsx
```

---

## ğŸ”§ é«˜çº§ç”¨æ³•

### 1. æ‰¹é‡å¯¼å‡ºï¼ˆåˆ†æ‰¹å¤„ç†ï¼‰

**åœºæ™¯**ï¼šéœ€è¦å¯¼å‡º 50 ä¸‡æ¡æ•°æ®

**æ–¹æ¡ˆ**ï¼šåˆ† 5 æ¬¡å¯¼å‡ºï¼Œæ¯æ¬¡ 10 ä¸‡æ¡

```bash
# ç¬¬ 1 æ‰¹ï¼š1-100000
curl -O -J "http://localhost:8080/api/excel/export?count=100000&fileName=è®¢å•æ•°æ®_ç¬¬1æ‰¹"

# ç¬¬ 2 æ‰¹ï¼š100001-200000ï¼ˆéœ€è¦ä¿®æ”¹ MockDataService æ”¯æŒ offsetï¼‰
# è¿™é‡Œä»…ä½œç¤ºä¾‹ï¼Œå®é™…éœ€è¦åœ¨ Service å±‚æ·»åŠ  offset å‚æ•°

# æˆ–è€…ä½¿ç”¨è„šæœ¬æ‰¹é‡ä¸‹è½½
for i in {1..5}; do
    curl -O -J "http://localhost:8080/api/excel/export?count=100000&fileName=è®¢å•æ•°æ®_ç¬¬${i}æ‰¹"
done
```

### 2. å®šæ—¶å¯¼å‡ºä»»åŠ¡

**Spring å®šæ—¶ä»»åŠ¡ç¤ºä¾‹**ï¼š

```java
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

@Component
public class ExcelExportScheduler {
    
    @Autowired
    private ExcelExportService excelExportService;
    
    /**
     * æ¯å¤©å‡Œæ™¨ 2 ç‚¹å¯¼å‡ºå‰ä¸€å¤©çš„è®¢å•æ•°æ®
     */
    @Scheduled(cron = "0 0 2 * * ?")
    public void exportDailyOrders() {
        try {
            // ç”Ÿæˆæ–‡ä»¶åˆ°æŒ‡å®šç›®å½•
            String filePath = "/data/exports/orders_" + 
                            new SimpleDateFormat("yyyyMMdd").format(new Date()) + ".xlsx";
            
            // æŸ¥è¯¢æ•°æ®
            List<LinkedHashMap<String, Object>> data = mockDataService.queryData(10000);
            
            // å¯¼å‡ºåˆ°æ–‡ä»¶
            FileOutputStream fos = new FileOutputStream(filePath);
            ExcelExportUtil.exportToStream(fos, data, "è®¢å•æ•°æ®", "è®¢å•åˆ—è¡¨");
            fos.close();
            
            logger.info("å®šæ—¶å¯¼å‡ºå®Œæˆ: {}", filePath);
            
        } catch (Exception e) {
            logger.error("å®šæ—¶å¯¼å‡ºå¤±è´¥", e);
        }
    }
}
```

### 3. å¼‚æ­¥å¯¼å‡ºï¼ˆå¤§æ•°æ®é‡ï¼‰

**å¼‚æ­¥å¯¼å‡ºç¤ºä¾‹**ï¼š

```java
import org.springframework.scheduling.annotation.Async;
import org.springframework.stereotype.Service;

@Service
public class AsyncExcelExportService {
    
    @Async
    public CompletableFuture<String> exportAsync(int count) {
        try {
            // 1. ç”Ÿæˆæ–‡ä»¶
            String fileName = "export_" + System.currentTimeMillis() + ".xlsx";
            String filePath = "/tmp/" + fileName;
            
            // 2. æŸ¥è¯¢æ•°æ®
            List<LinkedHashMap<String, Object>> data = mockDataService.queryData(count);
            
            // 3. å¯¼å‡ºåˆ°æ–‡ä»¶
            FileOutputStream fos = new FileOutputStream(filePath);
            ExcelExportUtil.exportToStream(fos, data, "æ•°æ®å¯¼å‡º", "Sheet1");
            fos.close();
            
            // 4. è¿”å›æ–‡ä»¶è·¯å¾„æˆ–ä¸‹è½½é“¾æ¥
            return CompletableFuture.completedFuture(filePath);
            
        } catch (Exception e) {
            logger.error("å¼‚æ­¥å¯¼å‡ºå¤±è´¥", e);
            return CompletableFuture.failedFuture(e);
        }
    }
}
```

**è°ƒç”¨ç¤ºä¾‹**ï¼š

```java
@RestController
public class AsyncExportController {
    
    @Autowired
    private AsyncExcelExportService asyncExportService;
    
    @PostMapping("/api/excel/export/async")
    public Map<String, Object> exportAsync(@RequestParam int count) {
        // æäº¤å¼‚æ­¥ä»»åŠ¡
        CompletableFuture<String> future = asyncExportService.exportAsync(count);
        
        // ç«‹å³è¿”å›ä»»åŠ¡ ID
        String taskId = UUID.randomUUID().toString();
        
        // ä»»åŠ¡å®Œæˆåçš„å›è°ƒ
        future.thenAccept(filePath -> {
            // å‘é€é€šçŸ¥ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ã€WebSocket ç­‰ï¼‰
            notifyUser(taskId, filePath);
        });
        
        Map<String, Object> result = new HashMap<>();
        result.put("success", true);
        result.put("taskId", taskId);
        result.put("message", "å¯¼å‡ºä»»åŠ¡å·²æäº¤ï¼Œå®Œæˆåå°†é€šçŸ¥æ‚¨");
        
        return result;
    }
}
```

---

## ğŸ› é”™è¯¯å¤„ç†ç¤ºä¾‹

### 1. æ•°æ®ä¸ºç©º

**è¯·æ±‚**ï¼š

```bash
# å‡è®¾æ•°æ®åº“æŸ¥è¯¢ç»“æœä¸ºç©ºï¼ˆéœ€è¦ä¿®æ”¹ MockDataServiceï¼‰
curl -O -J "http://localhost:8080/api/excel/export?count=0"
```

**å“åº”**ï¼š

```json
{
  "success": false,
  "message": "å¯¼å‡ºå¤±è´¥: å¯¼å‡ºæ•°æ®ä¸èƒ½ä¸ºç©º"
}
```

**HTTP çŠ¶æ€ç **ï¼š`500`

### 2. å‚æ•°éæ³•

**è¯·æ±‚**ï¼š

```bash
curl -O -J "http://localhost:8080/api/excel/export?count=-100"
```

**å¤„ç†**ï¼š

Service å±‚ä¼šè‡ªåŠ¨æ ¡éªŒå¹¶ä½¿ç”¨é»˜è®¤å€¼ 1000

**æ§åˆ¶å°æ—¥å¿—**ï¼š

```
WARN  ExcelExportService - æ•°æ®æ¡æ•°æ— æ•ˆ: -100, ä½¿ç”¨é»˜è®¤å€¼: 1000
```

### 3. æœåŠ¡å¼‚å¸¸

**å“åº”**ï¼š

```json
{
  "success": false,
  "message": "å¯¼å‡ºå¤±è´¥: java.io.IOException: ..."
}
```

**HTTP çŠ¶æ€ç **ï¼š`500`

---

## ğŸ“Š æ€§èƒ½æµ‹è¯•

### æµ‹è¯•ç¯å¢ƒ

- CPU: Intel i7-9750H (6æ ¸12çº¿ç¨‹)
- å†…å­˜: 16GB
- JDK: 1.8
- Spring Boot: 2.3.12

### æµ‹è¯•ç»“æœ

| æ•°æ®é‡ | æ•°æ®ç”Ÿæˆè€—æ—¶ | å¯¼å‡ºè€—æ—¶ | æ€»è€—æ—¶ | æ–‡ä»¶å¤§å° | å†…å­˜å ç”¨ |
|--------|------------|---------|--------|---------|---------|
| 1,000 | 50ms | 100ms | 150ms | 50KB | ~5MB |
| 10,000 | 200ms | 500ms | 700ms | 500KB | ~50MB |
| 50,000 | 1s | 2.5s | 3.5s | 2.5MB | ~250MB |
| 100,000 | 2s | 5s | 7s | 5MB | ~500MB |
| 150,000 | 3s | - | - | - | ~750MB |

**è¯´æ˜**ï¼š
- 150,000 æ¡æ•°æ®ä¼šè¢«æˆªæ–­ä¸º 100,000 æ¡
- å®é™…å¯¼å‡ºæ—¶é—´å’Œæ–‡ä»¶å¤§å°ä¸ 100,000 æ¡ç›¸åŒ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [01-åŠŸèƒ½è®¾è®¡è¯´æ˜.md](./01-åŠŸèƒ½è®¾è®¡è¯´æ˜.md) - åŠŸèƒ½è®¾è®¡
- [02-æ ¸å¿ƒä»£ç è¯´æ˜.md](./02-æ ¸å¿ƒä»£ç è¯´æ˜.md) - ä»£ç è¯¦è§£
- [README.md](./README.md) - é¡¹ç›®æ€»è§ˆ

---

## ğŸ“ æ€»ç»“

æœ¬æ–‡æ¡£æä¾›äº†å®Œæ•´çš„æ¥å£è°ƒç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ï¼š

1. **åŸºç¡€ç”¨æ³•**ï¼šcurlã€æµè§ˆå™¨ã€Postman
2. **ç¼–ç¨‹è°ƒç”¨**ï¼šJavaScriptã€Pythonã€Java
3. **é«˜çº§ç”¨æ³•**ï¼šæ‰¹é‡å¯¼å‡ºã€å®šæ—¶ä»»åŠ¡ã€å¼‚æ­¥å¯¼å‡º
4. **é”™è¯¯å¤„ç†**ï¼šå„ç§å¼‚å¸¸åœºæ™¯çš„å¤„ç†
5. **æ€§èƒ½æµ‹è¯•**ï¼šä¸åŒæ•°æ®é‡çš„æ€§èƒ½è¡¨ç°

é€‚ç”¨åœºæ™¯ï¼š
- âœ… è®¢å•æ•°æ®å¯¼å‡º
- âœ… ç”¨æˆ·æ•°æ®å¯¼å‡º
- âœ… æŠ¥è¡¨æ•°æ®å¯¼å‡º
- âœ… ä»»æ„ç»“æ„åŒ–æ•°æ®å¯¼å‡º
