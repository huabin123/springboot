# 04-è¡¨å¤´æ˜ å°„åŠŸèƒ½è¯´æ˜

## ğŸ“Œ åŠŸèƒ½æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜è¡¨å¤´æ˜ å°„åŠŸèƒ½çš„è®¾è®¡å’Œå®ç°ï¼Œè§£å†³æ•°æ®åº“å­—æ®µï¼ˆè‹±æ–‡ï¼‰åˆ° Excel è¡¨å¤´ï¼ˆä¸­æ–‡ï¼‰çš„æ˜ å°„é—®é¢˜ã€‚

---

## ğŸ¯ éœ€æ±‚èƒŒæ™¯

### å®é™…åœºæ™¯

åœ¨çœŸå®çš„é¡¹ç›®ä¸­ï¼Œé€šå¸¸å­˜åœ¨ä»¥ä¸‹æƒ…å†µï¼š

1. **æ•°æ®åº“å­—æ®µå**ï¼šä½¿ç”¨è‹±æ–‡å‘½åï¼ˆå¦‚ `orderNo`ã€`customerName`ï¼‰
2. **Excel è¡¨å¤´**ï¼šéœ€è¦æ˜¾ç¤ºä¸­æ–‡ï¼ˆå¦‚"è®¢å•ç¼–å·"ã€"å®¢æˆ·å§“å"ï¼‰
3. **çµæ´»é…ç½®**ï¼šä¸åŒå¯¼å‡ºåœºæ™¯å¯èƒ½éœ€è¦ä¸åŒçš„å­—æ®µé¡ºåºå’Œæ˜¾ç¤ºåç§°

### è§£å†³æ–¹æ¡ˆ

å¼•å…¥ `HeaderMapping` å®ä½“ç±»ï¼Œå®šä¹‰è‹±æ–‡å­—æ®µååˆ°ä¸­æ–‡è¡¨å¤´çš„æ˜ å°„å…³ç³»ã€‚

---

## ğŸ—ï¸ è®¾è®¡æ–¹æ¡ˆ

### 1. HeaderMapping å®ä½“ç±»

**æ–‡ä»¶ä½ç½®**ï¼š`src/main/java/com/huabin/excel/export/model/HeaderMapping.java`

**æ ¸å¿ƒå­—æ®µ**ï¼š

```java
public class HeaderMapping implements Serializable {
    
    /**
     * è‹±æ–‡å­—æ®µåï¼ˆæ•°æ®åº“å­—æ®µåï¼‰
     * ç”¨äºä» LinkedHashMap ä¸­å–å€¼
     */
    private String englishName;
    
    /**
     * ä¸­æ–‡å­—æ®µåï¼ˆExcel è¡¨å¤´åç§°ï¼‰
     * ç”¨äº Excel è¡¨å¤´æ˜¾ç¤º
     */
    private String chineseName;
    
    // æ„é€ å‡½æ•°ã€getterã€setter...
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
// åˆ›å»ºå•ä¸ªæ˜ å°„
HeaderMapping mapping = new HeaderMapping("orderNo", "è®¢å•ç¼–å·");

// æ‰¹é‡åˆ›å»ºæ˜ å°„åˆ—è¡¨
List<HeaderMapping> mappings = new ArrayList<>();
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
mappings.add(new HeaderMapping("phone", "è”ç³»ç”µè¯"));
mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));
```

---

### 2. æ•°æ®æŸ¥è¯¢æ”¹é€ 

**MockDataService æ”¹é€ å‰**ï¼š

```java
// æ—§ç‰ˆæœ¬ï¼šç›´æ¥ä½¿ç”¨ä¸­æ–‡å­—æ®µå
LinkedHashMap<String, Object> row = new LinkedHashMap<>();
row.put("è®¢å•ç¼–å·", "ORD0000000001");
row.put("å®¢æˆ·å§“å", "å¼ ä¼Ÿ");
row.put("è®¢å•é‡‘é¢", new BigDecimal("99.99"));
```

**MockDataService æ”¹é€ å**ï¼š

```java
// æ–°ç‰ˆæœ¬ï¼šä½¿ç”¨è‹±æ–‡å­—æ®µåï¼ˆæ¨¡æ‹ŸçœŸå®æ•°æ®åº“ï¼‰
LinkedHashMap<String, Object> row = new LinkedHashMap<>();
row.put("orderNo", "ORD0000000001");
row.put("customerName", "å¼ ä¼Ÿ");
row.put("amount", new BigDecimal("99.99"));

// æ–°å¢æ–¹æ³•ï¼šè·å–è¡¨å¤´æ˜ å°„é…ç½®
public List<HeaderMapping> getHeaderMappings() {
    List<HeaderMapping> mappings = new ArrayList<>();
    mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
    mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
    mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));
    return mappings;
}
```

---

### 3. å¯¼å‡ºå·¥å…·ç±»æ”¹é€ 

**ExcelExportUtil æ”¹é€ å‰**ï¼š

```java
public static void exportToResponse(HttpServletResponse response,
                                   List<LinkedHashMap<String, Object>> dataList,
                                   String fileName,
                                   String sheetName) {
    // ä»æ•°æ®ä¸­æå–è¡¨å¤´
    List<String> headers = extractHeaders(dataList);
    
    // è½¬æ¢æ•°æ®
    List<List<Object>> excelData = convertToExcelData(dataList, headers);
    
    // å¯¼å‡º
    EasyExcel.write(outputStream)
        .sheet(sheetName)
        .head(convertHeadersToList(headers))
        .doWrite(excelData);
}
```

**ExcelExportUtil æ”¹é€ å**ï¼š

```java
public static void exportToResponse(HttpServletResponse response,
                                   List<LinkedHashMap<String, Object>> dataList,
                                   List<HeaderMapping> headerMappings,  // æ–°å¢å‚æ•°
                                   String fileName,
                                   String sheetName) {
    // æå–ä¸­æ–‡è¡¨å¤´ï¼ˆç”¨äº Excel æ˜¾ç¤ºï¼‰
    List<String> chineseHeaders = extractChineseHeaders(headerMappings);
    
    // æå–è‹±æ–‡å­—æ®µåï¼ˆç”¨äºä»æ•°æ®ä¸­å–å€¼ï¼‰
    List<String> englishFields = extractEnglishFields(headerMappings);
    
    // æŒ‰ç…§æ˜ å°„é¡ºåºè½¬æ¢æ•°æ®
    List<List<Object>> excelData = convertToExcelDataWithMapping(dataList, englishFields);
    
    // å¯¼å‡ºï¼ˆè¡¨å¤´æ˜¾ç¤ºä¸­æ–‡ï¼‰
    EasyExcel.write(outputStream)
        .sheet(sheetName)
        .head(convertHeadersToList(chineseHeaders))
        .doWrite(excelData);
}

// æ–°å¢è¾…åŠ©æ–¹æ³•
private static List<String> extractChineseHeaders(List<HeaderMapping> headerMappings) {
    List<String> chineseHeaders = new ArrayList<>();
    for (HeaderMapping mapping : headerMappings) {
        chineseHeaders.add(mapping.getChineseName());
    }
    return chineseHeaders;
}

private static List<String> extractEnglishFields(List<HeaderMapping> headerMappings) {
    List<String> englishFields = new ArrayList<>();
    for (HeaderMapping mapping : headerMappings) {
        englishFields.add(mapping.getEnglishName());
    }
    return englishFields;
}

private static List<List<Object>> convertToExcelDataWithMapping(
        List<LinkedHashMap<String, Object>> dataList,
        List<String> englishFields) {
    List<List<Object>> excelData = new ArrayList<>();
    for (LinkedHashMap<String, Object> row : dataList) {
        List<Object> rowData = new ArrayList<>();
        // æŒ‰ç…§è‹±æ–‡å­—æ®µåé¡ºåºæå–å€¼
        for (String englishField : englishFields) {
            Object value = row.get(englishField);
            rowData.add(value != null ? value : "");
        }
        excelData.add(rowData);
    }
    return excelData;
}
```

---

### 4. æœåŠ¡å±‚æ”¹é€ 

**ExcelExportService æ”¹é€ **ï¼š

```java
public void exportData(HttpServletResponse response, 
                      Integer count, 
                      String fileName, 
                      String sheetName) throws IOException {
    
    // 1. å‚æ•°æ ¡éªŒå’Œé»˜è®¤å€¼è®¾ç½®
    count = validateAndSetDefaultCount(count);
    fileName = validateAndSetDefaultFileName(fileName);
    sheetName = validateAndSetDefaultSheetName(sheetName);

    // 2. æŸ¥è¯¢æ•°æ®ï¼ˆè¿”å›è‹±æ–‡å­—æ®µåï¼‰
    List<LinkedHashMap<String, Object>> dataList = mockDataService.queryData(count);

    // 3. è·å–è¡¨å¤´æ˜ å°„é…ç½®ï¼ˆè‹±æ–‡ -> ä¸­æ–‡ï¼‰
    List<HeaderMapping> headerMappings = mockDataService.getHeaderMappings();

    // 4. æ‰§è¡Œå¯¼å‡ºï¼ˆä¼ å…¥è¡¨å¤´æ˜ å°„ï¼‰
    ExcelExportUtil.exportToResponse(response, dataList, headerMappings, fileName, sheetName);
}
```

---

## ğŸ“Š æ•°æ®æµè½¬ç¤ºæ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®åº“æŸ¥è¯¢                                 â”‚
â”‚  SELECT order_no, customer_name, amount FROM orders         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                MockDataService.queryData()                   â”‚
â”‚  è¿”å›ï¼šList<LinkedHashMap<String, Object>>                  â”‚
â”‚  {                                                           â”‚
â”‚    "orderNo": "ORD0000000001",                              â”‚
â”‚    "customerName": "å¼ ä¼Ÿ",                                   â”‚
â”‚    "amount": 99.99                                          â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            MockDataService.getHeaderMappings()               â”‚
â”‚  è¿”å›ï¼šList<HeaderMapping>                                   â”‚
â”‚  [                                                           â”‚
â”‚    { englishName: "orderNo", chineseName: "è®¢å•ç¼–å·" },     â”‚
â”‚    { englishName: "customerName", chineseName: "å®¢æˆ·å§“å" },â”‚
â”‚    { englishName: "amount", chineseName: "è®¢å•é‡‘é¢" }       â”‚
â”‚  ]                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ExcelExportUtil.exportToResponse()              â”‚
â”‚  1. æå–ä¸­æ–‡è¡¨å¤´ï¼š["è®¢å•ç¼–å·", "å®¢æˆ·å§“å", "è®¢å•é‡‘é¢"]       â”‚
â”‚  2. æå–è‹±æ–‡å­—æ®µï¼š["orderNo", "customerName", "amount"]      â”‚
â”‚  3. æŒ‰è‹±æ–‡å­—æ®µé¡ºåºä»æ•°æ®ä¸­å–å€¼                               â”‚
â”‚  4. Excel è¡¨å¤´æ˜¾ç¤ºä¸­æ–‡                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¯¼å‡ºçš„ Excel æ–‡ä»¶                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚ è®¢å•ç¼–å· â”‚ å®¢æˆ·å§“å â”‚ è®¢å•é‡‘é¢ â”‚  â† ä¸­æ–‡è¡¨å¤´             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚  â”‚ ORD...01 â”‚   å¼ ä¼Ÿ   â”‚  99.99   â”‚                        â”‚
â”‚  â”‚ ORD...02 â”‚   ç‹èŠ³   â”‚  199.99  â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ å®é™…é¡¹ç›®åº”ç”¨

### è®¢å•æ•°æ®å¯¼å‡ºç¤ºä¾‹

```java
@Service
public class OrderExportService {
    
    @Autowired
    private OrderMapper orderMapper;
    
    public void exportOrders(HttpServletResponse response, OrderQueryParam param) {
        // 1. ä»æ•°æ®åº“æŸ¥è¯¢ï¼ˆè¿”å›è‹±æ–‡å­—æ®µåï¼‰
        List<Order> orders = orderMapper.selectByParam(param);
        
        // 2. è½¬æ¢ä¸º LinkedHashMapï¼ˆä½¿ç”¨è‹±æ–‡å­—æ®µåï¼‰
        List<LinkedHashMap<String, Object>> data = new ArrayList<>();
        for (Order order : orders) {
            LinkedHashMap<String, Object> row = new LinkedHashMap<>();
            row.put("orderNo", order.getOrderNo());
            row.put("customerName", order.getCustomerName());
            row.put("phone", order.getPhone());
            row.put("amount", order.getAmount());
            row.put("status", order.getStatus());
            row.put("orderTime", order.getCreateTime());
            data.add(row);
        }
        
        // 3. å®šä¹‰è¡¨å¤´æ˜ å°„ï¼ˆè‹±æ–‡ -> ä¸­æ–‡ï¼‰
        List<HeaderMapping> headerMappings = new ArrayList<>();
        headerMappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
        headerMappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
        headerMappings.add(new HeaderMapping("phone", "è”ç³»ç”µè¯"));
        headerMappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));
        headerMappings.add(new HeaderMapping("status", "è®¢å•çŠ¶æ€"));
        headerMappings.add(new HeaderMapping("orderTime", "ä¸‹å•æ—¶é—´"));
        
        // 4. å¯¼å‡ºï¼ˆä¼ å…¥è¡¨å¤´æ˜ å°„ï¼‰
        ExcelExportUtil.exportToResponse(response, data, headerMappings, "è®¢å•æ•°æ®", "è®¢å•åˆ—è¡¨");
    }
}
```

---

## âœ… æ”¹é€ ä¼˜åŠ¿

### 1. ç¬¦åˆçœŸå®åœºæ™¯

- âœ… æ•°æ®åº“å­—æ®µä½¿ç”¨è‹±æ–‡ï¼ˆè¡Œä¸šæ ‡å‡†ï¼‰
- âœ… Excel è¡¨å¤´æ˜¾ç¤ºä¸­æ–‡ï¼ˆç”¨æˆ·å‹å¥½ï¼‰
- âœ… æ˜ å°„å…³ç³»æ¸…æ™°æ˜ç¡®

### 2. çµæ´»æ€§æå‡

- âœ… å¯ä»¥è‡ªç”±è°ƒæ•´å­—æ®µé¡ºåºï¼ˆé€šè¿‡æ˜ å°„åˆ—è¡¨é¡ºåºï¼‰
- âœ… å¯ä»¥é€‰æ‹©æ€§å¯¼å‡ºå­—æ®µï¼ˆåªæ·»åŠ éœ€è¦çš„æ˜ å°„ï¼‰
- âœ… å¯ä»¥è‡ªå®šä¹‰è¡¨å¤´åç§°ï¼ˆä¸å—æ•°æ®åº“å­—æ®µé™åˆ¶ï¼‰

### 3. æ˜“äºç»´æŠ¤

- âœ… æ˜ å°„å…³ç³»é›†ä¸­ç®¡ç†
- âœ… ä¿®æ”¹è¡¨å¤´åç§°æ— éœ€æ”¹åŠ¨æ•°æ®æŸ¥è¯¢
- âœ… æ–°å¢å­—æ®µåªéœ€æ·»åŠ æ˜ å°„é…ç½®

### 4. ä»£ç æ¸…æ™°

- âœ… æ•°æ®å±‚å’Œå±•ç¤ºå±‚åˆ†ç¦»
- âœ… èŒè´£æ˜ç¡®ï¼Œæ˜“äºç†è§£
- âœ… ä¾¿äºå•å…ƒæµ‹è¯•

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€å¯¼å‡º

```bash
curl -O -J "http://localhost:8080/api/excel/export?count=5000"
```

**å¯¼å‡ºçš„ Excel**ï¼š

| è®¢å•ç¼–å· | å®¢æˆ·å§“å | è”ç³»ç”µè¯ | è®¢å•é‡‘é¢ | è®¢å•çŠ¶æ€ | ä¸‹å•æ—¶é—´ | æ”¶è´§åœ°å€ | å•†å“åç§° | å•†å“æ•°é‡ | å¤‡æ³¨ä¿¡æ¯ |
|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| ORD0000000001 | å¼ ä¼Ÿ | 13000000001 | 10.99 | å¾…æ”¯ä»˜ | 2025-12-30 20:04:00 | åŒ—äº¬å¸‚æœé˜³åŒºä¸­å±±è·¯1å· | ç”µå­äº§å“-iPhone | 2 | |
| ORD0000000002 | ç‹èŠ³ | 13000000002 | 11.98 | å·²æ”¯ä»˜ | 2025-12-30 20:03:00 | ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºäººæ°‘è·¯2å· | æœè£…é‹å¸½-Tæ¤ | 3 | |

**æ•°æ®ç»“æ„**ï¼ˆåå°ï¼‰ï¼š

```json
{
  "orderNo": "ORD0000000001",
  "customerName": "å¼ ä¼Ÿ",
  "phone": "13000000001",
  "amount": 10.99,
  "status": "å¾…æ”¯ä»˜",
  "orderTime": "2025-12-30 20:04:00",
  "address": "åŒ—äº¬å¸‚æœé˜³åŒºä¸­å±±è·¯1å·",
  "productName": "ç”µå­äº§å“-iPhone",
  "quantity": 2,
  "remark": ""
}
```

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•ä¿®æ”¹è¡¨å¤´æ˜¾ç¤ºåç§°ï¼Ÿ

**A:** ä¿®æ”¹ `getHeaderMappings()` æ–¹æ³•ä¸­çš„ä¸­æ–‡åç§°å³å¯

```java
// ä¿®æ”¹å‰
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));

// ä¿®æ”¹å
mappings.add(new HeaderMapping("orderNo", "è®¢å•å·"));
```

### Q2: å¦‚ä½•è°ƒæ•´å­—æ®µé¡ºåºï¼Ÿ

**A:** è°ƒæ•´ `getHeaderMappings()` æ–¹æ³•ä¸­æ˜ å°„çš„æ·»åŠ é¡ºåº

```java
// åŸé¡ºåºï¼šè®¢å•ç¼–å·ã€å®¢æˆ·å§“åã€è®¢å•é‡‘é¢
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));

// æ–°é¡ºåºï¼šå®¢æˆ·å§“åã€è®¢å•ç¼–å·ã€è®¢å•é‡‘é¢
mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));
```

### Q3: å¦‚ä½•åªå¯¼å‡ºéƒ¨åˆ†å­—æ®µï¼Ÿ

**A:** åªæ·»åŠ éœ€è¦å¯¼å‡ºçš„å­—æ®µæ˜ å°„

```java
// åªå¯¼å‡ºè®¢å•ç¼–å·ã€å®¢æˆ·å§“åã€è®¢å•é‡‘é¢
List<HeaderMapping> mappings = new ArrayList<>();
mappings.add(new HeaderMapping("orderNo", "è®¢å•ç¼–å·"));
mappings.add(new HeaderMapping("customerName", "å®¢æˆ·å§“å"));
mappings.add(new HeaderMapping("amount", "è®¢å•é‡‘é¢"));
// ä¸æ·»åŠ å…¶ä»–å­—æ®µçš„æ˜ å°„
```

### Q4: æ•°æ®åº“å­—æ®µåå’Œæ˜ å°„ä¸ä¸€è‡´ä¼šæ€æ ·ï¼Ÿ

**A:** å¦‚æœè‹±æ–‡å­—æ®µååœ¨æ•°æ®ä¸­ä¸å­˜åœ¨ï¼Œå¯¼å‡ºæ—¶è¯¥åˆ—ä¼šæ˜¾ç¤ºç©ºå€¼

```java
// æ•°æ®ä¸­æœ‰ "orderNo"
row.put("orderNo", "ORD0000000001");

// æ˜ å°„ä¸­å†™é”™äº†å­—æ®µå
mappings.add(new HeaderMapping("order_no", "è®¢å•ç¼–å·"));  // âŒ é”™è¯¯

// ç»“æœï¼šExcel ä¸­"è®¢å•ç¼–å·"åˆ—å…¨éƒ¨ä¸ºç©º
```

**æ­£ç¡®åšæ³•**ï¼šç¡®ä¿è‹±æ–‡å­—æ®µåä¸æ•°æ®ä¸­çš„ key å®Œå…¨ä¸€è‡´

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](./README.md) - é¡¹ç›®æ€»è§ˆ
- [01-åŠŸèƒ½è®¾è®¡è¯´æ˜.md](./01-åŠŸèƒ½è®¾è®¡è¯´æ˜.md) - åŠŸèƒ½è®¾è®¡
- [02-æ ¸å¿ƒä»£ç è¯´æ˜.md](./02-æ ¸å¿ƒä»£ç è¯´æ˜.md) - ä»£ç è¯¦è§£
- [03-ä½¿ç”¨ç¤ºä¾‹.md](./03-ä½¿ç”¨ç¤ºä¾‹.md) - ä½¿ç”¨ç¤ºä¾‹

---

## ğŸ‰ æ€»ç»“

è¡¨å¤´æ˜ å°„åŠŸèƒ½çš„å¼•å…¥ï¼Œä½¿å¾—é¡¹ç›®æ›´åŠ è´´è¿‘çœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. **çœŸå®æ€§**ï¼šæ•°æ®åº“å­—æ®µè‹±æ–‡ï¼ŒExcel è¡¨å¤´ä¸­æ–‡
2. **çµæ´»æ€§**ï¼šå¯è‡ªç”±é…ç½®å­—æ®µé¡ºåºå’Œæ˜¾ç¤ºåç§°
3. **å¯ç»´æŠ¤æ€§**ï¼šæ˜ å°„å…³ç³»é›†ä¸­ç®¡ç†ï¼Œæ˜“äºä¿®æ”¹
4. **æ‰©å±•æ€§**ï¼šæ”¯æŒä¸åŒå¯¼å‡ºåœºæ™¯çš„ä¸ªæ€§åŒ–é…ç½®

é€‚ç”¨äºæ‰€æœ‰éœ€è¦å°†æ•°æ®åº“æ•°æ®å¯¼å‡ºä¸º Excel çš„åœºæ™¯ï¼
